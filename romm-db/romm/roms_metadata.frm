TYPE=VIEW
query=select `r`.`id` AS `rom_id`,current_timestamp() AS `created_at`,current_timestamp() AS `updated_at`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.genres\'),json_extract(`r`.`moby_metadata`,\'$.genres\'),json_extract(`r`.`ss_metadata`,\'$.genres\'),json_extract(`r`.`launchbox_metadata`,\'$.genres\'),json_extract(`r`.`ra_metadata`,\'$.genres\'),json_extract(`r`.`flashpoint_metadata`,\'$.genres\'),json_array()) AS `genres`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.franchises\'),json_extract(`r`.`ss_metadata`,\'$.franchises\'),json_extract(`r`.`flashpoint_metadata`,\'$.franchises\'),json_array()) AS `franchises`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.collections\'),json_array()) AS `collections`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.companies\'),json_extract(`r`.`ss_metadata`,\'$.companies\'),json_extract(`r`.`ra_metadata`,\'$.companies\'),json_extract(`r`.`launchbox_metadata`,\'$.companies\'),json_extract(`r`.`flashpoint_metadata`,\'$.companies\'),json_array()) AS `companies`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.game_modes\'),json_extract(`r`.`ss_metadata`,\'$.game_modes\'),json_extract(`r`.`flashpoint_metadata`,\'$.game_modes\'),json_array()) AS `game_modes`,coalesce(case when json_contains_path(`r`.`igdb_metadata`,\'one\',\'$.age_ratings\') and json_length(json_extract(`r`.`igdb_metadata`,\'$.age_ratings\')) > 0 then json_extract(`r`.`igdb_metadata`,\'$.age_ratings[*].rating\') else json_array() end,case when json_contains_path(`r`.`launchbox_metadata`,\'one\',\'$.esrb\') and json_extract(`r`.`launchbox_metadata`,\'$.esrb\') is not null and json_extract(`r`.`launchbox_metadata`,\'$.esrb\') <> \'\' then json_array(json_extract(`r`.`launchbox_metadata`,\'$.esrb\')) else json_array() end,json_array()) AS `age_ratings`,case when json_contains_path(`r`.`igdb_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`igdb_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`igdb_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`igdb_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`ss_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`ss_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`ss_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`ss_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`ra_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`ra_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`ra_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`ra_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`launchbox_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`launchbox_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`launchbox_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`launchbox_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`flashpoint_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`flashpoint_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`flashpoint_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`flashpoint_metadata`,\'$.first_release_date\') as signed) * 1000 else NULL end AS `first_release_date`,case when `r`.`igdb_rating` is not null or `r`.`moby_rating` is not null or `r`.`ss_rating` is not null or `r`.`launchbox_rating` is not null then (coalesce(`r`.`igdb_rating`,0) + coalesce(`r`.`moby_rating`,0) + coalesce(`r`.`ss_rating`,0) + coalesce(`r`.`launchbox_rating`,0)) / (case when `r`.`igdb_rating` is not null then 1 else 0 end + case when `r`.`moby_rating` is not null then 1 else 0 end + case when `r`.`ss_rating` is not null then 1 else 0 end + case when `r`.`launchbox_rating` is not null then 1 else 0 end) else NULL end AS `average_rating` from (select `romm`.`roms`.`id` AS `id`,`romm`.`roms`.`igdb_metadata` AS `igdb_metadata`,`romm`.`roms`.`moby_metadata` AS `moby_metadata`,`romm`.`roms`.`ss_metadata` AS `ss_metadata`,`romm`.`roms`.`ra_metadata` AS `ra_metadata`,`romm`.`roms`.`launchbox_metadata` AS `launchbox_metadata`,`romm`.`roms`.`flashpoint_metadata` AS `flashpoint_metadata`,case when json_contains_path(`romm`.`roms`.`igdb_metadata`,\'one\',\'$.total_rating\') and json_unquote(json_extract(`romm`.`roms`.`igdb_metadata`,\'$.total_rating\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`igdb_metadata`,\'$.total_rating\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`igdb_metadata`,\'$.total_rating\') as decimal(10,2)) else NULL end AS `igdb_rating`,case when json_contains_path(`romm`.`roms`.`moby_metadata`,\'one\',\'$.moby_score\') and json_unquote(json_extract(`romm`.`roms`.`moby_metadata`,\'$.moby_score\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`moby_metadata`,\'$.moby_score\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`moby_metadata`,\'$.moby_score\') as decimal(10,2)) * 10 else NULL end AS `moby_rating`,case when json_contains_path(`romm`.`roms`.`ss_metadata`,\'one\',\'$.ss_score\') and json_unquote(json_extract(`romm`.`roms`.`ss_metadata`,\'$.ss_score\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`ss_metadata`,\'$.ss_score\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`ss_metadata`,\'$.ss_score\') as decimal(10,2)) * 10 else NULL end AS `ss_rating`,case when json_contains_path(`romm`.`roms`.`launchbox_metadata`,\'one\',\'$.community_rating\') and json_unquote(json_extract(`romm`.`roms`.`launchbox_metadata`,\'$.community_rating\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`launchbox_metadata`,\'$.community_rating\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`launchbox_metadata`,\'$.community_rating\') as decimal(10,2)) * 20 else NULL end AS `launchbox_rating` from `romm`.`roms`) `r`
md5=f28e30d2dcf6b51976dd98e6760f43cd
updatable=1
algorithm=0
definer_user=romm
definer_host=%
suid=2
with_check_option=0
timestamp=0001760481428933413
create-version=2
source=SELECT\n                        r.id as rom_id,\n                        NOW() AS created_at,\n                        NOW() AS updated_at,\n                        COALESCE(\n                            JSON_EXTRACT(r.igdb_metadata, \'$.genres\'),\n                            JSON_EXTRACT(r.moby_metadata, \'$.genres\'),\n                            JSON_EXTRACT(r.ss_metadata, \'$.genres\'),\n                            JSON_EXTRACT(r.launchbox_metadata, \'$.genres\'),\n                            JSON_EXTRACT(r.ra_metadata, \'$.genres\'),\n                            JSON_EXTRACT(r.flashpoint_metadata, \'$.genres\'),\n                            JSON_ARRAY()\n                        ) AS genres,\n\n                        COALESCE(\n                            JSON_EXTRACT(r.igdb_metadata, \'$.franchises\'),\n                            JSON_EXTRACT(r.ss_metadata, \'$.franchises\'),\n                            JSON_EXTRACT(r.flashpoint_metadata, \'$.franchises\'),\n                            JSON_ARRAY()\n                        ) AS franchises,\n\n                        COALESCE(\n                            JSON_EXTRACT(r.igdb_metadata, \'$.collections\'),\n                            JSON_ARRAY()\n                        ) AS collections,\n\n                        COALESCE(\n                            JSON_EXTRACT(r.igdb_metadata, \'$.companies\'),\n                            JSON_EXTRACT(r.ss_metadata, \'$.companies\'),\n                            JSON_EXTRACT(r.ra_metadata, \'$.companies\'),\n                            JSON_EXTRACT(r.launchbox_metadata, \'$.companies\'),\n                            JSON_EXTRACT(r.flashpoint_metadata, \'$.companies\'),\n                            JSON_ARRAY()\n                        ) AS companies,\n\n                        COALESCE(\n                            JSON_EXTRACT(r.igdb_metadata, \'$.game_modes\'),\n                            JSON_EXTRACT(r.ss_metadata, \'$.game_modes\'),\n                            JSON_EXTRACT(r.flashpoint_metadata, \'$.game_modes\'),\n                            JSON_ARRAY()\n                        ) AS game_modes,\n\n                        COALESCE(\n                            CASE\n                                WHEN JSON_CONTAINS_PATH(r.igdb_metadata, \'one\', \'$.age_ratings\')\n                                    AND JSON_LENGTH(JSON_EXTRACT(r.igdb_metadata, \'$.age_ratings\')) > 0\n                                THEN\n                                    JSON_EXTRACT(r.igdb_metadata, \'$.age_ratings[*].rating\')\n                                ELSE\n                                    JSON_ARRAY()\n                            END,\n                            CASE\n                                WHEN JSON_CONTAINS_PATH(r.launchbox_metadata, \'one\', \'$.esrb\')\n                                    AND JSON_EXTRACT(r.launchbox_metadata, \'$.esrb\') IS NOT NULL\n                                    AND JSON_EXTRACT(r.launchbox_metadata, \'$.esrb\') != \'\'\n                                THEN\n                                    JSON_ARRAY(JSON_EXTRACT(r.launchbox_metadata, \'$.esrb\'))\n                                ELSE\n                                    JSON_ARRAY()\n                            END,\n                            JSON_ARRAY()\n                        ) AS age_ratings,\n\n                        CASE\n                            WHEN JSON_CONTAINS_PATH(r.igdb_metadata, \'one\', \'$.first_release_date\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.igdb_metadata, \'$.first_release_date\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.igdb_metadata, \'$.first_release_date\')) REGEXP \'^[0-9]+$\'\n                            THEN CAST(JSON_EXTRACT(r.igdb_metadata, \'$.first_release_date\') AS SIGNED) * 1000\n\n                            WHEN JSON_CONTAINS_PATH(r.ss_metadata, \'one\', \'$.first_release_date\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.ss_metadata, \'$.first_release_date\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.ss_metadata, \'$.first_release_date\')) REGEXP \'^[0-9]+$\'\n                            THEN CAST(JSON_EXTRACT(r.ss_metadata, \'$.first_release_date\') AS SIGNED) * 1000\n\n                            WHEN JSON_CONTAINS_PATH(r.ra_metadata, \'one\', \'$.first_release_date\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.ra_metadata, \'$.first_release_date\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.ra_metadata, \'$.first_release_date\')) REGEXP \'^[0-9]+$\'\n                            THEN CAST(JSON_EXTRACT(r.ra_metadata, \'$.first_release_date\') AS SIGNED) * 1000\n\n                            WHEN JSON_CONTAINS_PATH(r.launchbox_metadata, \'one\', \'$.first_release_date\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.launchbox_metadata, \'$.first_release_date\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.launchbox_metadata, \'$.first_release_date\')) REGEXP \'^[0-9]+$\'\n                            THEN CAST(JSON_EXTRACT(r.launchbox_metadata, \'$.first_release_date\') AS SIGNED) * 1000\n\n                            WHEN JSON_CONTAINS_PATH(r.flashpoint_metadata, \'one\', \'$.first_release_date\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.flashpoint_metadata, \'$.first_release_date\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                JSON_UNQUOTE(JSON_EXTRACT(r.flashpoint_metadata, \'$.first_release_date\')) REGEXP \'^[0-9]+$\'\n                            THEN CAST(JSON_EXTRACT(r.flashpoint_metadata, \'$.first_release_date\') AS SIGNED) * 1000\n\n                            ELSE NULL\n                        END AS first_release_date,\n\n                        CASE\n                            WHEN (igdb_rating IS NOT NULL OR moby_rating IS NOT NULL OR ss_rating IS NOT NULL OR launchbox_rating IS NOT NULL) THEN\n                                (COALESCE(igdb_rating, 0) + COALESCE(moby_rating, 0) + COALESCE(ss_rating, 0) + COALESCE(launchbox_rating, 0)) /\n                                (CASE WHEN igdb_rating IS NOT NULL THEN 1 ELSE 0 END +\n                                CASE WHEN moby_rating IS NOT NULL THEN 1 ELSE 0 END +\n                                CASE WHEN ss_rating IS NOT NULL THEN 1 ELSE 0 END +\n                                CASE WHEN launchbox_rating IS NOT NULL THEN 1 ELSE 0 END)\n                            ELSE NULL\n                        END AS average_rating\n                    FROM (\n                        SELECT\n                            id,\n                            igdb_metadata,\n                            moby_metadata,\n                            ss_metadata,\n                            ra_metadata,\n                            launchbox_metadata,\n                            flashpoint_metadata,\n                            CASE\n                                WHEN JSON_CONTAINS_PATH(igdb_metadata, \'one\', \'$.total_rating\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(igdb_metadata, \'$.total_rating\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(igdb_metadata, \'$.total_rating\')) REGEXP \'^[0-9]+(\\.[0-9]+)?$\'\n                                THEN CAST(JSON_EXTRACT(igdb_metadata, \'$.total_rating\') AS DECIMAL(10,2))\n                                ELSE NULL\n                            END AS igdb_rating,\n                            CASE\n                                WHEN JSON_CONTAINS_PATH(moby_metadata, \'one\', \'$.moby_score\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(moby_metadata, \'$.moby_score\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(moby_metadata, \'$.moby_score\')) REGEXP \'^[0-9]+(\\.[0-9]+)?$\'\n                                THEN CAST(JSON_EXTRACT(moby_metadata, \'$.moby_score\') AS DECIMAL(10,2)) * 10\n                                ELSE NULL\n                            END AS moby_rating,\n                            CASE\n                                WHEN JSON_CONTAINS_PATH(ss_metadata, \'one\', \'$.ss_score\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(ss_metadata, \'$.ss_score\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(ss_metadata, \'$.ss_score\')) REGEXP \'^[0-9]+(\\.[0-9]+)?$\'\n                                THEN CAST(JSON_EXTRACT(ss_metadata, \'$.ss_score\') AS DECIMAL(10,2)) * 10\n                                ELSE NULL\n                            END AS ss_rating,\n                            CASE\n                                WHEN JSON_CONTAINS_PATH(launchbox_metadata, \'one\', \'$.community_rating\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(launchbox_metadata, \'$.community_rating\')) NOT IN (\'null\', \'None\', \'0\', \'0.0\') AND\n                                    JSON_UNQUOTE(JSON_EXTRACT(launchbox_metadata, \'$.community_rating\')) REGEXP \'^[0-9]+(\\.[0-9]+)?$\'\n                                THEN CAST(JSON_EXTRACT(launchbox_metadata, \'$.community_rating\') AS DECIMAL(10,2)) * 20\n                                ELSE NULL\n                            END AS launchbox_rating\n                        FROM roms\n                    ) AS r
client_cs_name=utf8mb4
connection_cl_name=utf8mb4_uca1400_ai_ci
view_body_utf8=select `r`.`id` AS `rom_id`,current_timestamp() AS `created_at`,current_timestamp() AS `updated_at`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.genres\'),json_extract(`r`.`moby_metadata`,\'$.genres\'),json_extract(`r`.`ss_metadata`,\'$.genres\'),json_extract(`r`.`launchbox_metadata`,\'$.genres\'),json_extract(`r`.`ra_metadata`,\'$.genres\'),json_extract(`r`.`flashpoint_metadata`,\'$.genres\'),json_array()) AS `genres`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.franchises\'),json_extract(`r`.`ss_metadata`,\'$.franchises\'),json_extract(`r`.`flashpoint_metadata`,\'$.franchises\'),json_array()) AS `franchises`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.collections\'),json_array()) AS `collections`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.companies\'),json_extract(`r`.`ss_metadata`,\'$.companies\'),json_extract(`r`.`ra_metadata`,\'$.companies\'),json_extract(`r`.`launchbox_metadata`,\'$.companies\'),json_extract(`r`.`flashpoint_metadata`,\'$.companies\'),json_array()) AS `companies`,coalesce(json_extract(`r`.`igdb_metadata`,\'$.game_modes\'),json_extract(`r`.`ss_metadata`,\'$.game_modes\'),json_extract(`r`.`flashpoint_metadata`,\'$.game_modes\'),json_array()) AS `game_modes`,coalesce(case when json_contains_path(`r`.`igdb_metadata`,\'one\',\'$.age_ratings\') and json_length(json_extract(`r`.`igdb_metadata`,\'$.age_ratings\')) > 0 then json_extract(`r`.`igdb_metadata`,\'$.age_ratings[*].rating\') else json_array() end,case when json_contains_path(`r`.`launchbox_metadata`,\'one\',\'$.esrb\') and json_extract(`r`.`launchbox_metadata`,\'$.esrb\') is not null and json_extract(`r`.`launchbox_metadata`,\'$.esrb\') <> \'\' then json_array(json_extract(`r`.`launchbox_metadata`,\'$.esrb\')) else json_array() end,json_array()) AS `age_ratings`,case when json_contains_path(`r`.`igdb_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`igdb_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`igdb_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`igdb_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`ss_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`ss_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`ss_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`ss_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`ra_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`ra_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`ra_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`ra_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`launchbox_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`launchbox_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`launchbox_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`launchbox_metadata`,\'$.first_release_date\') as signed) * 1000 when json_contains_path(`r`.`flashpoint_metadata`,\'one\',\'$.first_release_date\') and json_unquote(json_extract(`r`.`flashpoint_metadata`,\'$.first_release_date\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`r`.`flashpoint_metadata`,\'$.first_release_date\')) regexp \'^[0-9]+$\' then cast(json_extract(`r`.`flashpoint_metadata`,\'$.first_release_date\') as signed) * 1000 else NULL end AS `first_release_date`,case when `r`.`igdb_rating` is not null or `r`.`moby_rating` is not null or `r`.`ss_rating` is not null or `r`.`launchbox_rating` is not null then (coalesce(`r`.`igdb_rating`,0) + coalesce(`r`.`moby_rating`,0) + coalesce(`r`.`ss_rating`,0) + coalesce(`r`.`launchbox_rating`,0)) / (case when `r`.`igdb_rating` is not null then 1 else 0 end + case when `r`.`moby_rating` is not null then 1 else 0 end + case when `r`.`ss_rating` is not null then 1 else 0 end + case when `r`.`launchbox_rating` is not null then 1 else 0 end) else NULL end AS `average_rating` from (select `romm`.`roms`.`id` AS `id`,`romm`.`roms`.`igdb_metadata` AS `igdb_metadata`,`romm`.`roms`.`moby_metadata` AS `moby_metadata`,`romm`.`roms`.`ss_metadata` AS `ss_metadata`,`romm`.`roms`.`ra_metadata` AS `ra_metadata`,`romm`.`roms`.`launchbox_metadata` AS `launchbox_metadata`,`romm`.`roms`.`flashpoint_metadata` AS `flashpoint_metadata`,case when json_contains_path(`romm`.`roms`.`igdb_metadata`,\'one\',\'$.total_rating\') and json_unquote(json_extract(`romm`.`roms`.`igdb_metadata`,\'$.total_rating\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`igdb_metadata`,\'$.total_rating\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`igdb_metadata`,\'$.total_rating\') as decimal(10,2)) else NULL end AS `igdb_rating`,case when json_contains_path(`romm`.`roms`.`moby_metadata`,\'one\',\'$.moby_score\') and json_unquote(json_extract(`romm`.`roms`.`moby_metadata`,\'$.moby_score\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`moby_metadata`,\'$.moby_score\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`moby_metadata`,\'$.moby_score\') as decimal(10,2)) * 10 else NULL end AS `moby_rating`,case when json_contains_path(`romm`.`roms`.`ss_metadata`,\'one\',\'$.ss_score\') and json_unquote(json_extract(`romm`.`roms`.`ss_metadata`,\'$.ss_score\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`ss_metadata`,\'$.ss_score\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`ss_metadata`,\'$.ss_score\') as decimal(10,2)) * 10 else NULL end AS `ss_rating`,case when json_contains_path(`romm`.`roms`.`launchbox_metadata`,\'one\',\'$.community_rating\') and json_unquote(json_extract(`romm`.`roms`.`launchbox_metadata`,\'$.community_rating\')) not in (\'null\',\'None\',\'0\',\'0.0\') and json_unquote(json_extract(`romm`.`roms`.`launchbox_metadata`,\'$.community_rating\')) regexp \'^[0-9]+(.[0-9]+)?$\' then cast(json_extract(`romm`.`roms`.`launchbox_metadata`,\'$.community_rating\') as decimal(10,2)) * 20 else NULL end AS `launchbox_rating` from `romm`.`roms`) `r`
mariadb-version=120002
